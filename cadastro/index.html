<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastro ‚Äì Dynamic Performance</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 30px; }
    input, select, textarea { width: 100%; padding: 8px; margin-top: 10px; margin-bottom: 20px; }
    label { font-weight: bold; }
    button { padding: 10px 20px; background-color: #222; color: white; border: none; cursor: pointer; }
    button:hover { background-color: #444; }
    .mensagem { margin-top: 20px; padding: 10px; font-weight: bold; display: none; }
    .sucesso { background-color: #d4edda; color: #155724; }
    .erro { background-color: #f8d7da; color: #721c24; }
  </style>
</head>
<body>

  <h2>üìã Cadastro de Projeto ‚Äì Dynamic Solutions</h2>

  <form id="dynamicForm">
    <!-- Webhook din√¢mico -->
    <label for="webhook_url">üõ†Ô∏è Webhook do n8n (colar aqui):</label>
    <input type="url" id="webhook_url" placeholder="https://01n8n.autodynamic.tech/webhook-test/" required>

    <!-- CLIENTE -->
    <label for="nome_cliente">Nome do Cliente:</label>
    <input type="text" id="nome_cliente" name="nome_cliente" required>

    <label for="segmento">Segmento:</label>
    <input type="text" id="segmento" name="segmento" required>

    <label for="status_cliente">Status do Cliente:</label>
    <select id="status_cliente" name="status_cliente" required>
      <option value="ativo">Ativo</option>
      <option value="pausado">Pausado</option>
      <option value="encerrado">Encerrado</option>
    </select>

    <!-- PROJETO -->
    <label for="nome_projeto">Nome do Projeto:</label>
    <input type="text" id="nome_projeto" name="nome_projeto" required>

    <label for="objetivo_projeto">Objetivo do Projeto:</label>
    <textarea id="objetivo_projeto" name="objetivo_projeto" rows="3" required></textarea>

    <!-- CAMPANHA -->
    <label for="plataforma">Plataforma de Tr√°fego:</label>
    <select id="plataforma" name="plataforma" required>
      <option value="Meta Ads">Meta Ads</option>
      <option value="Google Ads">Google Ads</option>
    </select>

    <label for="verba_mensal">Verba Mensal (R$):</label>
    <input type="number" id="verba_mensal" name="verba_mensal" required>

    <!-- FUNIL -->
    <label for="tipo_funil">Tipo de Funil:</label>
    <select id="tipo_funil" name="tipo_funil" required>
      <option value="Agendamento WhatsApp">Agendamento WhatsApp</option>
      <option value="Captura de Leads">Captura de Leads</option>
      <option value="Venda Direta">Venda Direta</option>
    </select>

    <label for="landing_page">URL da Landing Page:</label>
    <input type="url" id="landing_page" name="landing_page">

    <!-- BOT√ÉO -->
    <button type="submit">Cadastrar</button>
  </form>

  <!-- FEEDBACK -->
  <div id="mensagem" class="mensagem"></div>

  <script>
    const form = document.getElementById('dynamicForm');
    const mensagem = document.getElementById('mensagem');

    form.addEventListener('submit', function(event) {
      event.preventDefault(); // impede o reload
      const webhook = document.getElementById('webhook_url').value.trim();

      if (!webhook) {
        mensagem.textContent = "‚ùå Cole a URL do webhook.";
        mensagem.className = "mensagem erro";
        mensagem.style.display = "block";
        return;
      }

      const formData = new FormData(form);
      const data = new URLSearchParams();
      for (const pair of formData) {
        data.append(pair[0], pair[1]);
      }

      fetch(webhook, {
        method: 'POST',
        body: data,
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        }
      })
      .then(response => {
        if (response.ok) {
          mensagem.textContent = "‚úÖ Cadastro realizado com sucesso!";
          mensagem.className = "mensagem sucesso";
          form.reset(); // limpa os campos
        } else {
          mensagem.textContent = "‚ùå Erro ao cadastrar. Verifique o webhook.";
          mensagem.className = "mensagem erro";
        }
        mensagem.style.display = "block";
      })
      .catch(() => {
        mensagem.textContent = "‚ùå Erro na conex√£o com o webhook.";
        mensagem.className = "mensagem erro";
        mensagem.style.display = "block";
      });
    });
  </script>

</body>
</html>
